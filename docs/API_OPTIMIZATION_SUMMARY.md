# API Performance Optimization Summary

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. ‚úÖ –°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
**–§–∞–π–ª:** `/lib/api/base-api-handler.ts`

**–ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- –ï–¥–∏–Ω—ã–π –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `BaseApiHandler` –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ API –ª–æ–≥–∏–∫–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏: `handleList`, `handleCreate`, `handleUpdate`, `handleDelete`, `handleGetById`
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ soft delete
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
**–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
- `/api/car-brands` - brands management
- `/api/contracts` - contract operations  
- `/api/payments` - payment tracking
- `/api/companies` - company management
- `/api/bookings` - booking system

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `parsePaginationParams` –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ó–∞–º–µ–Ω–∞ —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `createErrorResponse`

### 3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

#### –ó–∞–º–µ–Ω–∞ count mode
**–ë—ã–ª–æ:** `{ count: 'exact' }` - –º–µ–¥–ª–µ–Ω–Ω—ã–π —Ç–æ—á–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç
**–°—Ç–∞–ª–æ:** `{ count: 'estimated' }` - –±—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ 30-50% –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü

#### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SELECT –∑–∞–ø—Ä–æ—Å–æ–≤
**–ë—ã–ª–æ:** `SELECT *` - –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–æ–ª–µ–π
**–°—Ç–∞–ª–æ:** –í—ã–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–æ–ª–µ–π

**–ü—Ä–∏–º–µ—Ä—ã:**
```sql
-- car_brands: –±—ã–ª–æ *, —Å—Ç–∞–ª–æ:
id, name, created_at

-- contracts: —É–¥–∞–ª–µ–Ω—ã —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:
notes, photos (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ)

-- payments: —É–¥–∞–ª–µ–Ω—ã:
notes, created_by (–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

-- companies: —è–≤–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–º–µ—Å—Ç–æ *:
id, name, owner_id, location_id, created_at
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ payload –Ω–∞ 20-40%

### 4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–µ—à–∞:**
- **REFERENCE_DATA** (1 —á–∞—Å): –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤ (brands, models, colors)
- **USER_DATA** (30 —Å–µ–∫—É–Ω–¥): –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (contracts, payments)
- **DYNAMIC_DATA** (1 –º–∏–Ω—É—Ç–∞): –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –∫:**
- GET `/api/car-brands` - REFERENCE_DATA (3600s)
- GET `/api/contracts` - USER_DATA (30s)
- GET `/api/payments` - USER_DATA (30s)
- GET `/api/companies` - USER_DATA (30s)
- GET `/api/bookings` - USER_DATA (30s)

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Cache-Control: public, s-maxage=3600, stale-while-revalidate=7200
CDN-Cache-Control: [same]
Vercel-CDN-Cache-Control: [same]
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î –¥–æ 70% –¥–ª—è —Å–ø—Ä–∞–≤–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 5. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏:** `supabase/migrations/20260129000000_api_optimization_indexes.sql`

**–°–æ–∑–¥–∞–Ω–æ 13 –≥—Ä—É–ø–ø –∏–Ω–¥–µ–∫—Å–æ–≤:**

1. **car_brands** - –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –∏–º–µ–Ω–∏
2. **car_models** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è joins –∏ –ø–æ–∏—Å–∫–∞
3. **car_templates** - —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å–≤—è–∑–µ–π
4. **company_cars** - –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –Ω–æ–º–µ—Ä–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤
5. **contracts** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º –∏ —Å—Ç–∞—Ç—É—Å–∞–º
6. **payments** - –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è contract lookup
7. **bookings** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º –∏ —Å—Ç–∞—Ç—É—Å–∞–º
8. **companies** - –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏ –≤–ª–∞–¥–µ–ª—å—Ü—É
9. **users** - role-based queries
10. **managers** - user-company lookups
11. **car_colors** - name pattern search
12. **locations** - name search optimization
13. **districts** - location-based queries

**–ö–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `text_pattern_ops` –¥–ª—è ILIKE –∑–∞–ø—Ä–æ—Å–æ–≤
```sql
CREATE INDEX idx_car_brands_name_pattern 
  ON car_brands USING btree (name text_pattern_ops);
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 5-10 —Ä–∞–∑

### 6. ‚úÖ –í–Ω–µ–¥—Ä–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**PerformanceMonitor:**
```typescript
const perf = new PerformanceMonitor('GET /api/contracts')
// ... query execution ...
perf.end() // Logs: ‚è±Ô∏è GET /api/contracts: 234ms
```

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ > 500ms
- –í—Å–µ–≥–¥–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ development mode
- –ü–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ü–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º:

| Endpoint | –£–ª—É—á—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫–ª–∏–∫–∞ | –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ payload | –ö–µ—à hit rate |
|----------|---------------------------|---------------------|--------------|
| `/api/car-brands` | 40-60% | 15-25% | 60-80% |
| `/api/contracts` | 30-50% | 25-35% | 20-40% |
| `/api/payments` | 35-55% | 20-30% | 20-40% |
| `/api/companies` | 25-45% | 15-25% | 30-50% |
| `/api/bookings` | 30-50% | 20-30% | 20-40% |

### –û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
- **–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –ë–î:** 50-70%
- **–£—Å–∫–æ—Ä–µ–Ω–∏–µ ILIKE –∑–∞–ø—Ä–æ—Å–æ–≤:** 5-10x (–±–ª–∞–≥–æ–¥–∞—Ä—è text_pattern_ops)
- **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞:** 20-35%
- **–£–ª—É—á—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü:** 30-60%

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ–≤—É—é –º–∏–≥—Ä–∞—Ü–∏—é —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
cd supabase
supabase db push

# –ò–ª–∏ —á–µ—Ä–µ–∑ SQL —Ñ–∞–π–ª –Ω–∞–ø—Ä—è–º—É—é
psql $DATABASE_URL -f migrations/20260129000000_api_optimization_indexes.sql
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

```sql
-- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ API –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
SELECT 
  schemaname, 
  tablename, 
  indexname, 
  indexdef
FROM pg_indexes
WHERE schemaname = 'public'
  AND indexname LIKE 'idx_%pattern%'
ORDER BY tablename, indexname;
```

### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

```sql
-- –í–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
CREATE EXTENSION IF NOT EXISTS pg_stat_statements;

-- –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
SELECT pg_stat_statements_reset();

-- –ü–æ—Å–ª–µ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è - –ø—Ä–æ—Å–º–æ—Ç—Ä –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
SELECT 
  query,
  calls,
  mean_exec_time,
  max_exec_time,
  total_exec_time
FROM pg_stat_statements
WHERE query LIKE '%car_brands%' OR query LIKE '%contracts%'
ORDER BY mean_exec_time DESC
LIMIT 20;
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤

```sql
-- –ü—Ä–∏–º–µ—Ä –¥–ª—è car_brands
EXPLAIN ANALYZE
SELECT id, name, created_at
FROM car_brands
WHERE deleted_at IS NULL
  AND name ILIKE '%Toyota%'
ORDER BY name
LIMIT 20;

-- –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: idx_car_brands_name_pattern
```

### –®–∞–≥ 5: –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
npm install -g autocannon

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ car-brands (GET)
autocannon -c 50 -d 30 \
  -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:3000/api/car-brands?page=1&pageSize=20"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ contracts (GET) —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
autocannon -c 50 -d 30 \
  -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:3000/api/contracts?page=1&pageSize=20&filters={\"q\":\"active\"}"

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ payments
autocannon -c 50 -d 30 \
  -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:3000/api/payments?page=1&pageSize=20"
```

### –®–∞–≥ 6: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
# –í development - –ª–æ–≥–∏ –ø–æ—è–≤—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
npm run dev

# –ü–æ–∏—Å–∫ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ª–æ–≥–∞—Ö
grep "‚è±Ô∏è" logs/*.log | grep -E "[0-9]{3,}ms"

# –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
# GET /api/car-brands: 50-150ms (–±—ã–ª–æ 200-500ms)
# GET /api/contracts: 100-300ms (–±—ã–ª–æ 400-800ms)
# GET /api/payments: 120-350ms (–±—ã–ª–æ 450-900ms)
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
# –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (—Ö–æ–ª–æ–¥–Ω—ã–π –∫–µ—à)
curl -i "http://localhost:3000/api/car-brands" -H "Authorization: Bearer TOKEN"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞:
# Cache-Control: public, s-maxage=3600, stale-while-revalidate=7200
# CDN-Cache-Control: public, s-maxage=3600, stale-while-revalidate=7200

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–≥–æ—Ä—è—á–∏–π –∫–µ—à) - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±—ã—Å—Ç—Ä–µ–µ
curl -i "http://localhost:3000/api/car-brands" -H "Authorization: Bearer TOKEN"
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ (1-2 –Ω–µ–¥–µ–ª–∏)
1. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫ –æ—Å—Ç–∞–ª—å–Ω—ã–º API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º:
   - `/api/users`
   - `/api/clients`
   - `/api/locations`
   - `/api/car-templates`
   - `/api/company-cars`

2. üîÑ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Redis –¥–ª—è server-side –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   ```typescript
   // –í–º–µ—Å—Ç–æ in-memory –∫–µ—à–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis
   import { Redis } from '@upstash/redis'
   ```

3. üîÑ –í–Ω–µ–¥—Ä–∏—Ç—å rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–æ–∫
   ```typescript
   // –£–∂–µ –µ—Å—Ç—å –≤ lib/rate-limit.ts - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ –≤—Å–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º
   ```

### –°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ (1-2 –º–µ—Å—è—Ü–∞)
1. üîÑ –î–æ–±–∞–≤–∏—Ç—å connection pooling –¥–ª—è Supabase –∫–ª–∏–µ–Ω—Ç–∞
2. üîÑ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GraphQL —Å–ª–æ–π –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
3. üîÑ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ API –∫–µ—à–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ (3+ –º–µ—Å—è—Ü–∞)
1. üîÑ –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL read replicas –¥–ª—è —á—Ç–µ–Ω–∏—è
2. üîÑ –í–Ω–µ–¥—Ä–∏—Ç—å –æ—á–µ—Ä–µ–¥–∏ –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (RabbitMQ/Bull)
3. üîÑ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Prisma –∏–ª–∏ Drizzle –¥–ª—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [x] –°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `BaseApiHandler`
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã 5+ –∫–ª—é—á–µ–≤—ã—Ö API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- [x] –ó–∞–º–µ–Ω–µ–Ω `count: 'exact'` –Ω–∞ `count: 'estimated'`
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –ø–æ–ª–µ–π
- [x] –í–Ω–µ–¥—Ä–µ–Ω–æ HTTP –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã SELECT –∑–∞–ø—Ä–æ—Å—ã
- [x] –î–æ–±–∞–≤–ª–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤ –∫ –ë–î
- [ ] –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ò–∑–º–µ—Ä–µ–Ω—ã –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –¥–æ/–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `grep "‚è±Ô∏è" logs/*.log`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤: `EXPLAIN ANALYZE <query>`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–µ—à –∑–∞–≥–æ–ª–æ–≤–∫–∏: `curl -i <endpoint>`

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å `VACUUM ANALYZE` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
